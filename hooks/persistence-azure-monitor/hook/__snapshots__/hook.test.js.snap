// SPDX-FileCopyrightText: the secureCodeBox authors
//
// SPDX-License-Identifier: Apache-2.0
// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`should batch multiple findings in a single call 1`] = `
[
  [
    "https://123123.ods.opinsights.azure.com/api/logs?api-version=2016-04-01",
    {
      "body": "[{"id":"4560b3e6-1219-4f5f-9b44-6579f5a32407","name":"Port 5601 is open","category":"Open Port","scan_id":"09988cdf-1fc7-4f85-95ee-1b1d65dbc7cc","scan_name":"demo-scan","scan_type":"Nmap","scan_parameters":["-Pn","localhost"],"scan_labels":{"company":"iteratec"}},{"id":"4560b3e6-1219-4f5f-9b44-6579f5a32407","name":"Port 5601 is open","category":"Open Port","scan_id":"09988cdf-1fc7-4f85-95ee-1b1d65dbc7cc","scan_name":"demo-scan","scan_type":"Nmap","scan_parameters":["-Pn","localhost"],"scan_labels":{"company":"iteratec"}}]",
      "headers": {
        "Authorization": "SharedKey 123123:Kbjs2pD2xj5jEP0iaLF24RiMKCHX0Oy1cJIs0YVC/04=",
        "Log-Type": "SCB_Nmap",
        "content-type": "application/json",
        "x-ms-date": "Wed, 11 Nov 2020 00:00:00 GMT",
      },
      "method": "POST",
    },
  ],
]
`;

exports[`should pull settings from env variables 1`] = `
[
  [
    "https://123123.ods.opinsights.azure.com/api/logs?api-version=2016-04-01",
    {
      "body": "[{"id":"4560b3e6-1219-4f5f-9b44-6579f5a32407","name":"Port 5601 is open","category":"Open Port","scan_id":"09988cdf-1fc7-4f85-95ee-1b1d65dbc7cc","scan_name":"demo-scan","scan_type":"Nmap","scan_parameters":["-Pn","localhost"],"scan_labels":{"company":"iteratec"}}]",
      "headers": {
        "Authorization": "SharedKey 123123:NGgRdMUyh3Ed5fB+qS3kJU6B3u6/dt34uP7aPYBgLXg=",
        "Log-Type": "SCB_Nmap",
        "content-type": "application/json",
        "x-ms-date": "Wed, 11 Nov 2020 00:00:00 GMT",
      },
      "method": "POST",
    },
  ],
]
`;

exports[`should send findings to Azure Monitor 1`] = `
[
  [
    "https://123123.ods.opinsights.azure.com/api/logs?api-version=2016-04-01",
    {
      "body": "[{"id":"4560b3e6-1219-4f5f-9b44-6579f5a32407","name":"Port 5601 is open","category":"Open Port","scan_id":"09988cdf-1fc7-4f85-95ee-1b1d65dbc7cc","scan_name":"demo-scan","scan_type":"Nmap","scan_parameters":["-Pn","localhost"],"scan_labels":{"company":"iteratec"}}]",
      "headers": {
        "Authorization": "SharedKey 123123:NGgRdMUyh3Ed5fB+qS3kJU6B3u6/dt34uP7aPYBgLXg=",
        "Log-Type": "SCB_Nmap",
        "content-type": "application/json",
        "x-ms-date": "Wed, 11 Nov 2020 00:00:00 GMT",
      },
      "method": "POST",
    },
  ],
]
`;
