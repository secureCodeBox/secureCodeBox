suite: Full Snapshot
tests:
  - it: matches the snapshot
    chart:
      version: 0.0.0
      appVersion: 0.0.0        
    set:
      ## Finding Post Processing Hook Specific Configuration
      rules:
        [
          {
            matches:
              [
                {
                  anyOf:
                    [
                      {
                        category: "Open Port",
                        attributes: {port: 21, state: open},
                      },
                      {
                        category: "Open Port",
                        attributes: {port: 389, state: open},
                      },
                    ],
                },
              ],
            override: {severity: "high", description: "Telnet is bad"},
          },
        ]
      ## Generic Configuration        
      imagePullSecrets: [{name: foo}]
      hook:
        labels: {foo: bar}
        annotations: {foo: bar}
        priority: 100
        ttlSecondsAfterFinished: 100
        tolerations:
          [{key: foo, operator: Exists, value: "value1", effect: NoSchedule}]
        affinity:
          nodeAffinity:
            requiredDuringSchedulingIgnoredDuringExecution:
              nodeSelectorTerms:
                - matchExpressions:
                    - {key: foo, operator: In, values: [bar, baz]}
        resources: {requests: {cpu: "100m", memory: "100Mi"}}
        extraVolumes: [{name: foo, emptyDir: {}}]
        extraVolumeMounts: [{name: foo, mountPath: /foo}]
        env: [{name: foo, value: bar}]
    asserts:
      - matchSnapshot: {}
