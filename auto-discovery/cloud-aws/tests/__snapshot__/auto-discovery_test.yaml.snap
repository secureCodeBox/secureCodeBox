matches the snapshot:
  1: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      name: auto-discovery-cloud-aws
    rules:
      - apiGroups:
          - execution.securecodebox.io
        resources:
          - scantypes
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - execution.securecodebox.io
        resources:
          - scheduledscans
        verbs:
          - create
          - get
          - list
          - patch
          - update
          - watch
          - delete
      - apiGroups:
          - execution.securecodebox.io/status
        resources:
          - scheduledscans
        verbs:
          - get
          - patch
          - update
      - apiGroups:
          - execution.securecodebox.io
        resources:
          - scans
        verbs:
          - create
          - get
          - list
          - patch
          - update
          - watch
          - delete
      - apiGroups:
          - execution.securecodebox.io/status
        resources:
          - scans
        verbs:
          - get
          - patch
          - update
  2: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      name: auto-discovery-cloud-aws
      namespace: NAMESPACE
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: auto-discovery-cloud-aws
    subjects:
      - kind: ServiceAccount
        name: auto-discovery-cloud-aws
        namespace: NAMESPACE
  3: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: auto-discovery-cloud-aws
  4: |
    apiVersion: v1
    data:
      auto-discovery-cloud-aws.yaml: |
        {
          "aws": {
            "queueUrl": "",
            "region": ""
          },
          "kubernetes": {
            "namespace": "",
            "scanConfigs": [
              {
                "annotations": {},
                "hookSelector": {},
                "labels": {},
                "name": "trivy",
                "parameters": [
                  "{{ .ImageID }}"
                ],
                "repeatInterval": "168h",
                "scanType": "trivy-image"
              },
              {
                "annotations": {},
                "hookSelector": {},
                "labels": {},
                "name": "trivy-sbom",
                "parameters": [
                  "{{ .ImageID }}"
                ],
                "repeatInterval": "168h",
                "scanType": "trivy-sbom-image"
              }
            ]
          }
        }
    kind: ConfigMap
    metadata:
      name: auto-discovery-cloud-aws
  5: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      labels:
        control-plane: auto-discovery-cloud-aws
      name: auto-discovery-cloud-aws
    spec:
      replicas: 1
      selector:
        matchLabels:
          control-plane: auto-discovery-cloud-aws
      template:
        metadata:
          labels:
            control-plane: auto-discovery-cloud-aws
        spec:
          containers:
            - args:
                - --config
                - /etc/securecodebox/auto-discovery-cloud-aws.yaml
              command:
                - /service
              env:
                - name: AWS_ACCESS_KEY_ID
                  valueFrom:
                    secretKeyRef:
                      key: aws-access-key-id
                      name: aws-credentials
                      optional: true
                - name: AWS_SECRET_ACCESS_KEY
                  valueFrom:
                    secretKeyRef:
                      key: aws-secret-access-key
                      name: aws-credentials
                      optional: true
                - name: AWS_SESSION_TOKEN
                  valueFrom:
                    secretKeyRef:
                      key: aws-session-token
                      name: aws-credentials
                      optional: true
              image: securecodebox/auto-discovery-cloud-aws:0.0.0
              imagePullPolicy: IfNotPresent
              name: auto-discovery-cloud-aws
              resources:
                limits:
                  cpu: 100m
                  memory: 100Mi
                requests:
                  cpu: 100m
                  memory: 20Mi
              securityContext:
                allowPrivilegeEscalation: false
                capabilities:
                  drop:
                    - all
                privileged: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/securecodebox/auto-discovery-cloud-aws.yaml
                  name: config
                  readOnly: true
                  subPath: auto-discovery-cloud-aws.yaml
          imagePullSecrets:
            - name: foo
          securityContext:
            fsGroup: 1234
          serviceAccountName: auto-discovery-cloud-aws
          terminationGracePeriodSeconds: 10
          volumes:
            - configMap:
                name: auto-discovery-cloud-aws
              name: config
