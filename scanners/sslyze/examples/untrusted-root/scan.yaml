# SPDX-FileCopyrightText: the secureCodeBox authors
#
# SPDX-License-Identifier: Apache-2.0

apiVersion: v1
kind: ConfigMap
metadata:
  name: custom-root-ca
data:
  # This is a mock root CA certificate for demonstration purposes
  # In a real scenario, you would replace this with your actual internal/private CA certificate
  root-ca.pem: |-
    -----BEGIN CERTIFICATE-----
    MIIDXTCCAkWgAwIBAgIJAKL0UG+mRKSzMA0GCSqGSIb3DQEBCwUAMEUxCzAJBgNV
    ...
    9qS6wZ0yC2sL8nK5xR7tH0qS7wZ1yD3sL9nL6xR8tI1qS8w==
    -----END CERTIFICATE-----

---
apiVersion: "execution.securecodebox.io/v1"
kind: Scan
metadata:
  name: "sslyze-untrusted-root-with-ca"
spec:
  scanType: "sslyze"
  parameters:
    # Provide the custom CA file to validate certificates
    - "--certinfo_ca_file"
    - "/ca-certs/root-ca.pem"
    # Target host with untrusted root certificate
    - "untrusted-root.example.com"
  volumeMounts:
    - name: custom-root-ca
      mountPath: /ca-certs
      readOnly: true
  volumes:
    - name: custom-root-ca
      configMap:
        name: custom-root-ca